<!DOCTYPE html>
<html lang="en">

<head>
  <title>By Mona</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  <link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Vidaloka" rel="stylesheet" />

  <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css" />
  <link rel="stylesheet" href="css/animate.css" />

  <link rel="stylesheet" href="css/owl.carousel.min.css" />
  <link rel="stylesheet" href="css/owl.theme.default.min.css" />
  <link rel="stylesheet" href="css/magnific-popup.css" />

  <link rel="stylesheet" href="css/aos.css" />

  <link rel="stylesheet" href="css/ionicons.min.css" />

  <link rel="stylesheet" href="css/bootstrap-datepicker.css" />
  <link rel="stylesheet" href="css/jquery.timepicker.css" />

  <link rel="stylesheet" href="css/flaticon.css" />
  <link rel="stylesheet" href="css/icomoon.css" />
  <link rel="stylesheet" href="css/admin.css" />
  <link rel="stylesheet" href="css/list-product.css">
  <!-- <link rel="stylesheet" href="css/style.css"> -->
</head>

<body>
  <div class="admin">
    <div id="titleListProducts">
      <img src="images/logo.jpg" alt="" />
      <a href="admin459375483957.html">Volver al Administrador</a>
    </div>

    <br />
    <div id="listOfProducts">

    </div>
  </div>

  <script type="module">

    function RestoreBack() {
      window.location.reload();
    }

    var ArrayOfProducts = [];

    window.deleteProduct = deleteProduct;
    window.addEventListener("load", GetAllProducts);

    function GetAllProducts() {
      const dbref = ref(realdb);

      get(child(dbref, "products")).then((snapshot) => {
        snapshot.forEach((prod) => {
          ArrayOfProducts.push(prod.val());
        });
        AddAllProducts();
      });
    }

    function AddAllProducts() {
      let i = 0;
      ArrayOfProducts.forEach((prod) => {
        AddAProduct(prod, i++);
      });
    }

    async function deleteProduct(productId) {

      const realdb = getDatabase();
      const dbref = ref(realdb);

      await set(ref(realdb, "products/" + productId), null);

      alert('Producto borrado');
      RestoreBack();

    }

    function AddAProduct(product, index) {
      //AGREGAR HTML

      var div = document.getElementById("listOfProducts");

      div.innerHTML += `	
			<div id="item">
        <img src="${product.linksOfImagesArray[0]}"/>
        <h2>${product.productTitle}</h2>
        <img onClick={deleteProduct("${product.id}")} src="images/cancel.png"/>
        
      </div>
		  `
        ;

    }


    // ---------------- FIREBASE ----------------- //

    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAguwNQu-9ohom5ZC1SMOv-UKbeJeg982g",
      authDomain: "bymona-8dccf.firebaseapp.com",
      projectId: "bymona-8dccf",
      storageBucket: "bymona-8dccf.appspot.com",
      messagingSenderId: "672892089620",
      appId: "1:672892089620:web:c3d7e94fcd73c12289be01",
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);

    // import firebase storage funtcions

    import {
      getStorage,
      ref as sRef,
      uploadBytesResumable,
      getDownloadURL,
    } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-storage.js";

    // Firebase Realtime Database
    import {
      getDatabase,
      ref,
      set,
      child,
      get,
    } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-database.js";
    const realdb = getDatabase();

  </script>

  <script src="js/jquery.min.js"></script>
  <script src="js/jquery-migrate-3.0.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script src="js/jquery.waypoints.min.js"></script>
  <script src="js/jquery.stellar.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/jquery.animateNumber.min.js"></script>
  <script src="js/scrollax.min.js"></script>
  <script src="js/jquery.mb.YTPlayer.min.js"></script>
  <script src="js/bootstrap-datepicker.js"></script>
  <script src="js/jquery.timepicker.min.js"></script>
  <script src="js/main.js"></script>
</body>

</html>